function preview(e){if(e.files&&e.files[0]){var a=new FileReader,s=$("#image_preview_container"),r=$("#image_preview"),t=$("#polaroid");a.onload=function(e){t.removeClass("notify"),r.removeClass("active"),r.css("margin-left",""),r.css("margin-top",""),r.removeClass("active"),s.addClass("busy"),s.removeClass("blur"),s.css("background-image",""),r.attr("src",e.target.result),r.css("margin-left",-(parseInt(r.css("width"))/2)+"px"),r.css("margin-top",-(parseInt(r.css("height"))/2)-20+"px");var a=new ColorThief,i=a.getColor(r[0]);i="rgb("+i[0]+","+i[1]+","+i[2]+")",s.css("background-color",i);var l=a.getPalette(r[0]),o=$("#palette");$(o).find("*:not(.title)").remove(),setTimeout(function(){t.addClass("notify"),r.addClass("active"),s.addClass("blur"),s.css("background-image","url("+e.target.result+")"),s.removeClass("busy");for(var a=0;a<l.length;a++){i="rgb("+l[a][0]+","+l[a][1]+","+l[a][2]+")";var n="<div class=swab_container><div class=swab style='background-color:"+i+"''></div><label>"+i+"</label></div>";o.append(n).hide().delay(1e3*a).fadeIn(300)}},1e3)},a.readAsDataURL(e.files[0])}}