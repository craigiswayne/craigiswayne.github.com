server {

    listen       80;
    server_name  www.landbou.com local.landbou.com;
    root   html/landbou.com;

    port_in_redirect off;

    error_log  html/logs/error-landbou.com.log;
    access_log html/logs/access-landbou.com.log;

    location / {

        try_files $uri $uri/ /index.php?$args;
        index index.php index.html index.htm;
    }


    fastcgi_ignore_headers "Cache-Control" "Expires" "Set-Cookie";

    location = /nginx.conf {
        return 404;
    }
    location = /dump.zip {
        return 404;
    }
    location = /wwww.zip {
        return 404;
    }
    location = /web.zip {
        return 404;
    }
    location = /readme.html {
        return 404;
    }
    location = /readme.md {
        return 404;
    }
    location = /readme.htm {
        return 404;
    }
    location = /license.html {
        return 404;
    }
    location = /license.txt {
        return 404;
    }

    location = /robots.txt { access_log off; log_not_found off; }
    location = /favicon.ico { access_log off; log_not_found off; }

    location ~ ^/(status-fpm)$ {
        access_log off;
        include fastcgi_params;
        fastcgi_pass 127.0.0.1:9000;
    }

    location ~ ^/(status-nginx)$ {
        access_log off;
        #stub_status on;
    }

	rewrite ^/sitemapindex\.xml$ /index.php?gxs_module=sitemapindex last;
	rewrite ^/post\.xml$ /index.php?gxs_module=post last;
	rewrite ^/page\.xml$ /index.php?gxs_module=page last;
	rewrite ^/post_google_news\.xml$ /index.php?gxs_module=post_google_news last;
	rewrite ^/taxonomy_category\.xml$ /index.php?gxs_module=taxonomy_category last;

   location ~* ^.+\.(jpg|jpeg|gif|css|png|js|ico|html|xml|txt)$ {
        access_log        off;
        expires           max;
        log_not_found off;
    }

    location ~ [^/]\.php(/|$) {

        fastcgi_split_path_info ^(.+?\.php)(/.*)$;

        if (!-f $document_root$fastcgi_script_name) { return 404; }

        try_files $uri $uri/ /index.php?$args;
        fastcgi_pass 127.0.0.1:9000;
        fastcgi_index index.php;

        fastcgi_split_path_info             ^(.+.php)(.*)$;
        fastcgi_intercept_errors            on;
        fastcgi_ignore_client_abort         off;
        fastcgi_send_timeout                120;
        fastcgi_read_timeout                120;

        fastcgi_buffers 256 16k;
        fastcgi_max_temp_file_size 0;

        fastcgi_temp_file_write_size        256k;

        fastcgi_param   SCRIPT_FILENAME     $document_root$fastcgi_script_name;
        fastcgi_param   QUERY_STRING        $query_string;
        fastcgi_param   REQUEST_METHOD      $request_method;
        fastcgi_param   CONTENT_TYPE        $content_type;
        fastcgi_param   CONTENT_LENGTH      $content_length;
        fastcgi_param   SCRIPT_NAME         $fastcgi_script_name;
        fastcgi_param   REQUEST_URI         $request_uri;
        fastcgi_param   DOCUMENT_URI        $document_uri;
        fastcgi_param   DOCUMENT_ROOT       $document_root;
        fastcgi_param   SERVER_PROTOCOL     $server_protocol;
        fastcgi_param   GATEWAY_INTERFACE   CGI/1.1;
        fastcgi_param   SERVER_SOFTWARE     nginx/$nginx_version;
        fastcgi_param   REMOTE_ADDR         $remote_addr;
        fastcgi_param   REMOTE_PORT         $remote_port;
        fastcgi_param   SERVER_ADDR         $server_addr;
        fastcgi_param   SERVER_PORT         $server_port;

        fastcgi_param   SERVER_NAME         $server_name;
        fastcgi_param   HTTPS               $https;

        # PHP only, required if PHP was built with --enable-force-cgi-redirect
        fastcgi_param   REDIRECT_STATUS     200;

        add_header X-Optinet-Server "tfcpt-lsweb08";
    }
}
