###
# References:
# - https://www.digitalocean.com/community/tutorials/how-to-add-the-gzip-module-to-nginx-on-ubuntu-14-04
# - https://www.linode.com/docs/web-servers/nginx/configure-nginx-for-optimized-performance
#
###


# Keep Alive / Requests
keepalive_timeout     65;
keepalive_requests    100000;
sendfile              on;
tcp_nopush            on;
tcp_nodelay           on;
fastcgi_read_timeout  300;


# GZIP
gzip                  on;
gzip_disable          "MSIE [1-6]\.";
gzip_vary             on;
gzip_proxied          any;
gzip_comp_level       6;
gzip_buffers          16 8k;
gzip_http_version     1.1;
gzip_types            application/javascript text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript application/vnd.ms-fontobject application/x-font-ttf font/opentype image/svg+xml image/x-icon;
gzip_min_length       1000;



# Buffer Size
client_body_buffer_size       128k;
client_max_body_size          10m;
client_header_buffer_size     1k;
large_client_header_buffers   4 128k;
output_buffers                1 32k;
postpone_output               1460;


# Timeouts
client_header_timeout  10s;
client_body_timeout    10s;
send_timeout           3m;


# Static Asset Serving
open_file_cache max=1000 inactive=20s;
open_file_cache_valid 30s;
open_file_cache_min_uses 5;
open_file_cache_errors off;


# Missing Client Responses
reset_timedout_connection on;


# Caching
proxy_cache_path /usr/local/etc/nginx/cache keys_zone=one:10m;
