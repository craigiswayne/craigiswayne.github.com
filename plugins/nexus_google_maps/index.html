<html>

	<head>
		<title>Nexus Google Maps | Demo</title>
		<!--<script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>-->
		<script src='http://maps.googleapis.com/maps/api/js?libraries=places&amp;sensor=false'></script>
		<script src="../../js/nexus.js"></script>
		<script src="nexus_google_maps.js"></script>
		<link href="nexus_google_maps.css" rel="stylesheet">
		

		<link rel=stylesheet href="../../css/tutorials.css">
		<script>			
			var realtime_distance_map_options = {
				track: true,
				tracking_completed: get_nearby_garages
			};
			
			var tracking_with_guide_options = {
				markers: [
					{
						title: "Cape Town",
						track: true,
						position: new google.maps.LatLng(-33.924868,18.424055) //cape town
					}
				],
				track: true,
				users_position_updated: show_guide_to_first_marker 
			};
			
			function get_nearby_garages(container){
				var garages_nearby = [];
				var service = new google.maps.places.PlacesService(container.map);  
				var request = {
					location: container.users_position.google_obj,
					radius: "5000",
					query: "garage"
				};
				
				service.textSearch(request, function(results, status, pagination){
					if (status == google.maps.places.PlacesServiceStatus.OK){
						
						for(var i=0; i<5; i++){
							var marker_settings = {
								title: results[i].name,
								position: results[i].geometry.location,
								track: true
							};
							container.add_marker(marker_settings);
						}
					}
				});
			}
			
			function show_guide_to_first_marker(container){
				var request = {
					origin:			container.users_position.google_obj,
					destination:	container.markers[0].position,
					travelMode: 	google.maps.TravelMode.DRIVING
				};
				container.get_directions(request);				
			}
		</script>
		
		<style>
			.nexus.google_maps{
				max-height:300px;
			}
		</style>
		
	</head>
	
	<body>
		<fieldset class=example>
			<legend>Tracking with Guide (Realtime)</legend>
			<div class="nexus google_maps" data-options="tracking_with_guide_options"></div>
		</fieldset>
	
		<fieldset class=example>
			<legend>Track Your Location (Realtime)</legend>
			<div class="nexus google_maps" data-track="true" data-maxZoom="8"></div>
		</fieldset>
		
		<fieldset class=example>
			<legend>Distance Calculator (Realtime) (Nearby Garages)</legend>
			<div class="nexus google_maps" data-options="realtime_distance_map_options"></div>
		</fieldset>
		
		
		<fieldset class=example>
			<legend>Inline settings (data-zoom=5)</legend>
			<div class="nexus google_maps" data-zoom="5"></div>
		</fieldset>
	</body>

</html>
